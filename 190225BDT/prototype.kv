
<FrontEndGUI>:
    orientation: 'horizontal'
    meshlist_panel: meshlist_panel_id
    case_spinner: case_spinner_id
    datalist_panel: datalist_panel_id

#    dummybutton: dummybutton_id

    BoxLayout:
        orientation: 'vertical'
        size_hint_x: 0.5
        Button:
            text: "add mesh"
            size_hint: 1, 0.1
            on_release: meshlist_panel_id.show_loadmeshdialog()

        ScrollView:
            MeshListPanel:
                id: meshlist_panel_id
                size_hint_y: None                    # Need this as well to make ScrollView work !
                height: self.minimum_height          # Need this to update the TreeView's height dynamicalll to make ScrollView work
#            root_options: dict(text='Tree One')
                hide_root: True
                indent_start: 25        # this affects the level 0 node, i.e. the first level if root is hidden
                indent_level: 20

    BoxLayout:
        orientation: 'vertical'
        size_hint_x: 0.5

        BoxLayout:
            size_hint_y: 0.1
            orientation: 'horizontal'
            
            CaseSpinner:
                id: case_spinner_id
            Button:
                size_hint_x: 0.4
                text: "add case"
                on_release: case_spinner_id.show_addcasedialog()

        BoxLayout:
            size_hint_y: 0.1
            orientation: 'horizontal'

            Label:
                text:
            Button:
                size_hint_x: 0.4
                text: "add data"
                on_release: datalist_panel_id.show_adddatadialog()

        DataListPanel:
            id: datalist_panel_id

#        Button:
#            id: dummybutton_id
#            text: "dummy button"
#            size_hint: 1, 0.1
#            on_release: meshlist_panel_id.show_loadmeshdialog()


############################################
############# meshlist_panel tree ##########

#### TreeView nodes ####

<MeshBranchNode>:
    height: app.root.height*0.06
    orientation: 'horizontal'

    BoxLayout:                           # dummy transparent box to push the button to the right in order to show the drop-down arrow
        size_hint_x: 0.02
        background_color: (0, 0, 0, 0)

    Button:
        text: root.mesh_name
#        background_color: (0, 0, 0, 0)
        on_release: app.root.meshlist_panel.toggle_node(root)      # here you need to give "root" (the TreeViewButton node) as the argument rather than "self" (the Button itself)

    Button:
        size_hint_x: 0.3
        text: "change"

<MeshInfoNodeNode>:
    orientation: 'horizontal'

    Label:
        text: "mesh details"

    BoxLayout:
        size_hint_x: 0.3
        orientation: 'vertical'

        Button:
            text: "cases >"
#            on_release: app.root.case_spinner.choose_mesh_case(root.parent_node.mesh_name)
            on_release: app.bdt.set_current_mesh(root.parent_node.mesh_name)
        Button:
            text: "add info"
            on_release: app.root.meshlist_panel.show_load_data_dialog()

<GeomInfoNodeNode>:
    orientation: 'horizontal'
    height: dp(35)

    Label:
        text: root.data_name+" ("+root.data_unit+")"

    Button:                            # "Button" Capital initial! not "button". Otherwise will get traceback error takes hours to track down
        size_hint_x: 0.2
        text: "change"

####

#### dialogs as contents for popup ####

<LoadMeshDialog>:
    orientation: 'vertical'

#    Label:
#        text: "mesh name"

#    TextInput:
#        id: new_mesh_name_id
#        multiline: False

    FileChooserIconView:
        id: filechooser_id

    BoxLayout:
        size_hint_y: 0.15
        orientation: 'horizontal'
        Button:
            size_hint: 0.5, 1
            text: "Add"
            on_release: root.load(filechooser_id.selection[0])
        Button:
            size_hint: 0.5, 1
            text: "Cancel"
            on_release: root.cancel()

<LoadDataDialog>:
    orientation: 'vertical'

    BoxLayout:
        size_hint_y: 0.15
        Label:
            text: "data name"
        TextInput:
            id: data_name_id
            multiline: False
        Label:
            text: "unit"
        TextInput:
            id: data_unit_id

    FileChooserListView:
        id: datafilechooser_id

    BoxLayout:
        size_hint_y: 0.15
        orientation: 'horizontal'
        Button:
            size_hint: 0.5, 1
            text: "Add"
            on_release: root.load(data_name_id.text, data_unit_id.text)
        Button:
            size_hint: 0.5, 1
            text: "Cancel"
            on_release: root.cancel()

####

###### end of  meshlist_panel tree #####
########################################

####### run case spinner #########

<CaseSpinner>:
    size_hint_x: 0.6
    text_autoupdate: True

#    text: '<select>'
    on_text: app.bdt.set_current_case(self.text)

<AddCaseDialog>:
    orientation: 'vertical'

    BoxLayout:
        size_hint_y: 0.2
        orientation: 'horizontal'
        Label:
            text: "case name"
        TextInput:
            id: case_name_id
            multiline: False

    BoxLayout:
        orientation: 'horizontal'
        Label:
            text: "description"
        TextInput:
            id: description_id

    BoxLayout:
        orientation: 'horizontal'
        Button:
            text: "Add"
            on_release: root.load(case_name_id.text, description_id.text)

        Button:
            text: "Cancel"
            on_release: root.cancel()

####

####### data list RecycleView #########

<DataListPanel>:
    viewclass: "DataItem"

    RecycleBoxLayout:                # you need this block to make the recycleview show items
        default_size: None, dp(36)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: 'vertical'

<DataItem>:
    Button:
        text: root.data_name+" ("+root.data_unit+")"

<AddDataDialog>:
    orientation: 'vertical'

    BoxLayout:
        size_hint_y: 0.2
        orientation: 'horizontal'
        Label:
            text: "data name"
        TextInput:
            id: data_name_id
            multiline: False
        Label:
            text: "unit"
        TextInput:
            id: data_unit_id
            multiline: False

    FileChooserListView:
        id: datafilechooser_id

    BoxLayout:
        size_hint_y: 0.15
        orientation: 'horizontal'
        Button:
            size_hint: 0.5, 1
            text: "Add"
            on_release: root.load(data_name_id.text, data_unit_id.text)
        Button:
            size_hint: 0.5, 1
            text: "Cancel"
            on_release: root.cancel()
